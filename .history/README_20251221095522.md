# üì± E-Commerce Phone Store - Monorepo Project

> üî§ **Ng√¥n ng·ªØ m·∫∑c ƒë·ªãnh: ti·∫øng Vi·ªát** cho t√†i li·ªáu, PR/Issue v√† b√¨nh lu·∫≠n review.

D·ª± √°n monorepo bao g·ªìm backend API (Express.js + TypeScript) v√† 2 frontend apps (Next.js) cho h·ªá th·ªëng b√°n ƒëi·ªán tho·∫°i v√† s·∫£n ph·∫©m Apple.

## üìã M·ª•c L·ª•c

- [T·ªïng Quan](#t·ªïng-quan)
- [Tech Stack](#tech-stack)
- [C·∫•u Tr√∫c D·ª± √Ån](#c·∫•u-tr√∫c-d·ª±-√°n)
- [H∆∞·ªõng D·∫´n C√†i ƒê·∫∑t](#h∆∞·ªõng-d·∫´n-c√†i-ƒë·∫∑t)
- [Ch·∫°y ·ª®ng D·ª•ng](#ch·∫°y-·ª©ng-d·ª•ng)
- [Bi·∫øn M√¥i Tr∆∞·ªùng](#bi·∫øn-m√¥i-tr∆∞·ªùng)
- [API Documentation](#api-documentation)
- [ƒê√≥ng G√≥p](#ƒë√≥ng-g√≥p)
- [Troubleshooting](#troubleshooting)

## üéØ T·ªïng Quan

D·ª± √°n n√†y l√† m·ªôt h·ªá th·ªëng e-commerce ho√†n ch·ªânh v·ªõi:

- **Backend**: RESTful API v·ªõi authentication, RBAC (Role-Based Access Control), session management
- **Frontend**: Modern React app v·ªõi Next.js, UI components, authentication flows
- **Database**: PostgreSQL v·ªõi Prisma ORM

## üõ† Tech Stack

### Backend

- **Runtime**: Node.js + TypeScript
- **Framework**: Express.js
- **Database**: PostgreSQL
- **ORM**: Prisma
- **Authentication**: JWT + Sessions
- **Validation**: Zod
- **API Documentation**: HTTP files cho testing

### Frontend

- **Framework**: Next.js 14+
- **Language**: TypeScript
- **Styling**: CSS + UI Components (shadcn/ui compatible)
- **State Management**: React Hooks
- **API Client**: Axios-based
- **Authentication**: Session-based with JWT tokens

### DevOps

- **Containerization**: Docker & Docker Compose
- **Package Manager**: npm
- **Version Control**: Git

## üìÅ C·∫•u Tr√∫c D·ª± √Ån

```
newpro/
‚îú‚îÄ‚îÄ backend/                          # Backend API
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app.ts                   # Express app setup
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.ts                 # Server entry point
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers/             # Request handlers
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/                # Business logic
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes/                  # API routes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schemas/                 # Zod validation schemas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ middlewares/             # Express middlewares
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/                   # Utilities (JWT, cookies, env, etc.)
‚îÇ   ‚îú‚îÄ‚îÄ prisma/                      # Database
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schema.prisma           # Prisma schema
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ migrations/             # Database migrations
‚îÇ   ‚îú‚îÄ‚îÄ scripts/                    # Utility scripts (create-admin, etc.)
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îú‚îÄ‚îÄ tsconfig.json
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yml
‚îÇ   ‚îú‚îÄ‚îÄ test-simple.http            # HTTP testing files
‚îÇ   ‚îî‚îÄ‚îÄ test-rbac.http
‚îÇ
‚îú‚îÄ‚îÄ phone-app/                        # Next.js Frontend
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app/                    # Next.js app directory
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx          # Root layout
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx            # Home page
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ (auth)/             # Authentication routes
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ (account)/          # Account routes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/             # Reusable components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth-provider.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login-form.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ (others)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lib/                    # Utility libraries
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.ts              # API client
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth-client.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ token.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/                  # Custom React hooks
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/                  # Utilities
‚îÇ   ‚îú‚îÄ‚îÄ public/                     # Static assets
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îú‚îÄ‚îÄ tsconfig.json
‚îÇ   ‚îú‚îÄ‚îÄ next.config.ts
‚îÇ   ‚îî‚îÄ‚îÄ README.md
‚îÇ
‚îú‚îÄ‚îÄ .github/                         # GitHub config
‚îÇ   ‚îî‚îÄ‚îÄ copilot-instructions.md
‚îú‚îÄ‚îÄ .gitignore                       # Git ignore patterns
‚îú‚îÄ‚îÄ GIT_TROUBLESHOOTING.md          # Git troubleshooting guide
‚îî‚îÄ‚îÄ README.md                        # This file
```

## üöÄ H∆∞·ªõng D·∫´n C√†i ƒê·∫∑t

### Y√™u C·∫ßu Ti√™n Quy·∫øt

- Node.js >= 16.x
- npm >= 8.x
- PostgreSQL >= 12.x (for local development)
- Docker & Docker Compose (optional, for containerized setup)

### Clone Repository

```bash
git clone https://github.com/huyshelby/tesst.git
cd newpro
```

### Backend Setup

```bash
cd backend

# C√†i dependencies
npm install

# Setup environment variables (t·∫°o file .env)
# Xem m·∫´u ·ªü ph·∫ßn Bi·∫øn M√¥i Tr∆∞·ªùng

# T·∫°o database v√† ch·∫°y migrations
npx prisma migrate dev

# Kh·ªüi t·∫°o admin user (optional)
npm run create-admin

# Ki·ªÉm tra API setup
npm run dev
```

### Frontend Setup

```bash
cd ../phone-app

# C√†i dependencies
npm install

# Setup environment variables (t·∫°o file .env.local)
# NEXT_PUBLIC_API_URL=http://localhost:3001

# Ch·∫°y dev server
npm run dev
```

## üé¨ Ch·∫°y ·ª®ng D·ª•ng

### Development Mode

**Backend** (Terminal 1):

```bash
cd backend
npm run dev
# Server ch·∫°y t·∫°i http://localhost:3001
```

**Frontend** (Terminal 2):

```bash
cd phone-app
npm run dev
# App ch·∫°y t·∫°i http://localhost:3000
```

### S·ª≠ D·ª•ng Docker Compose

```bash
cd backend
docker-compose up
```

ƒêi·ªÅu n√†y s·∫Ω:

- Kh·ªüi ƒë·ªông PostgreSQL container
- T·ª± ƒë·ªông ch·∫°y migrations
- Chu·∫©n b·ªã database cho development

### Build & Production

**Backend**:

```bash
cd backend
npm run build
npm start
```

**Frontend**:

```bash
cd phone-app
npm run build
npm start
```

## üîê Bi·∫øn M√¥i Tr∆∞·ªùng

### Backend (.env)

```env
# Server
PORT=3001
NODE_ENV=development

# Database
DATABASE_URL="postgresql://user:password@localhost:5432/phone_app"

# JWT
JWT_SECRET=your_jwt_secret_key_here

# Session
SESSION_SECRET=your_session_secret_key_here

# CORS
CORS_ORIGIN=http://localhost:3000

# Email (optional)
EMAIL_USER=your_email@gmail.com
EMAIL_PASSWORD=your_app_password
```

### Frontend (.env.local)

```env
NEXT_PUBLIC_API_URL=http://localhost:3001
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

## üìö API Documentation

### Authentication Routes

- `POST /api/auth/register` - User registration
- `POST /api/auth/login` - User login
- `POST /api/auth/logout` - User logout
- `POST /api/auth/refresh` - Refresh JWT token
- `POST /api/auth/forgot` - Forgot password
- `POST /api/auth/reset` - Reset password

### User Routes

- `GET /api/users/me` - Get current user profile
- `PUT /api/users/me` - Update user profile
- `GET /api/users/:id` - Get user by ID

### Admin Routes (Protected - Requires Admin Role)

- `GET /api/admin/users` - List all users
- `POST /api/admin/users/:id/role` - Assign role to user
- `DELETE /api/admin/users/:id` - Delete user

### Testing

S·ª≠ d·ª•ng file `.http` ƒë·ªÉ test API:

```bash
# V·ªõi VS Code REST Client extension ho·∫∑c ƒë∆°n gi·∫£n:
curl -X POST http://localhost:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"user@example.com","password":"password"}'
```

Chi ti·∫øt xem [API-RBAC.md](./backend/API-RBAC.md)

## üìù Database Schema

### Users

- id (UUID)
- email (unique)
- name
- password (hashed)
- createdAt
- updatedAt

### Sessions

- id (UUID)
- userId (FK)
- token
- expiresAt
- createdAt

### User Roles

- id (UUID)
- userId (FK)
- role (enum: USER, ADMIN, MODERATOR)

### Products, Categories, Orders

(Schema ƒë·∫ßy ƒë·ªß xem trong `prisma/schema.prisma`)

## üë• ƒê√≥ng G√≥p

1. **Fork** repository
2. **T·∫°o branch** cho feature: `git checkout -b feature/your-feature`
3. **Commit** changes: `git commit -m "Add your feature"`
4. **Push** to branch: `git push origin feature/your-feature`
5. **T·∫°o Pull Request**

### Coding Standards

- S·ª≠ d·ª•ng TypeScript
- Follow ESLint rules
- Vi·∫øt comments ti·∫øng Vi·ªát cho logic ph·ª©c t·∫°p
- T·∫°o commit message r√µ r√†ng

## üêõ Troubleshooting

### Git Issues

N·∫øu g·∫∑p l·ªói li√™n quan ƒë·∫øn Git (submodule, large files, etc.):
‚Üí Xem chi ti·∫øt trong [GIT_TROUBLESHOOTING.md](./GIT_TROUBLESHOOTING.md)

### Database Connection

```bash
# Ki·ªÉm tra DATABASE_URL
echo $DATABASE_URL

# Ki·ªÉm tra PostgreSQL service
pg_isready -h localhost -p 5432

# Reset migrations
npx prisma migrate reset
```

### Port Already in Use

```bash
# Windows
netstat -ano | findstr :3001
taskkill /PID <PID> /F

# macOS/Linux
lsof -i :3001
kill -9 <PID>
```

### Node Modules Issues

```bash
# Clear cache
npm cache clean --force

# Reinstall
rm -rf node_modules package-lock.json
npm install
```

## üìû Support & Contact

- **Issues**: GitHub Issues
- **Discussions**: GitHub Discussions
- **Email**: (Add if applicable)

## üìÑ License

MIT License - xem [LICENSE](./LICENSE) file

## üîÑ Changelog

### v1.0.0 (Current)

- ‚úÖ Basic authentication with JWT
- ‚úÖ Role-based access control (RBAC)
- ‚úÖ User session management
- ‚úÖ Next.js frontend with React
- ‚úÖ PostgreSQL database with Prisma
- ‚úÖ Docker support

---

**Cu·ªëi c√πng c·∫≠p nh·∫≠t**: December 13, 2025
